<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>기업회원 마이페이지</title>
    <style>
        .container { display: flex; }
        .menu { width: 200px; background-color: #eee; padding: 10px; height: 100vh; }
        .content { flex: 1; padding: 20px; }
        .menu a { display: block; margin-bottom: 10px; text-decoration: none; }
    </style>
</head>
<body>

<div style="background-color: #f2f2f2; padding: 10px;">
    <a th:href="@{/member/main}">🏠 메인으로</a>
</div>

<div class="container">
    <div class="menu">
        <h4>📂 메뉴</h4>
        <a href="#" onclick="showSection('info')">기업 정보</a>
        <a href="#" onclick="showSection('posts')">공고 관리</a>
        <a href="#" onclick="showSection('applicants')">지원자 관리</a>
        <a href="#" onclick="showSection('edit')">회원 정보 수정</a>
    </div>

    <div class="content">
        <!-- 기업 정보 -->
        <div id="info" style="display: block;">
            <h3>📌 기업 정보</h3>
            <p>기업명: <span th:text="${member.name}"></span></p>
            <p>설립일자: <span th:text="${member.birthDate}"></span></p>
            <p>전화번호: <span th:text="${member.phone}"></span></p>
            <p>주소: <span th:text="${member.address}"></span></p>
        </div>

        <!-- 공고 관리 -->
        <div id="posts" style="display: none;">
            <h3>📄 공고 관리</h3>

            <div th:if="${#lists.isEmpty(posts)}">
                <p>등록된 공고가 없습니다.</p>
            </div>

            <div th:unless="${#lists.isEmpty(posts)}">
                <table border="1" cellpadding="5" style="width: 100%; text-align: center;">
                    <thead>
                    <tr>
                        <th>제목</th>
                        <th>급여</th>
                        <th>주소</th>
                        <th>마감일</th>
                        <th>등록일</th>
                        <th>관리</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="post : ${posts}">
                        <td th:text="${post.title}"></td>
                        <td th:text="${post.salary}"></td>
                        <td th:text="${post.address}"></td>
                        <td th:text="${#temporals.format(post.deadline, 'yyyy-MM-dd')}"></td>
                        <td th:text="${#temporals.format(post.postedDate, 'yyyy-MM-dd')}"></td>
                        <td>
                            <a th:href="@{'/post/view/' + ${post.postId}}">보기</a> |
                            <a th:href="@{'/post/edit/' + ${post.postId}}">수정</a> |
                            <form th:action="@{'/post/delete/' + ${post.postId}}" method="post" style="display:inline;">
                                <button type="submit" onclick="return confirm('정말 삭제하시겠습니까?')">삭제</button>
                            </form>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <br/>
            <button onclick="location.href='/post/create'">📢 새 공고 등록</button>
        </div>

        <!-- 지원자 관리 -->
        <div id="applicants" style="display: none;">
            <h3>👥 지원자 목록</h3>

            <div th:if="${#lists.isEmpty(applicants)}">
                <p>지원자가 없습니다.</p>
            </div>

            <div th:unless="${#lists.isEmpty(applicants)}">
                <table border="1" cellpadding="5" style="width: 100%; text-align: center;">
                    <thead>
                    <tr>
                        <th>공고 제목</th>
                        <th>지원자 이름</th>
                        <th>전화번호</th>
                        <th>지원일</th>
                        <th>이력서</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="app : ${applicants}">
                        <td th:text="${app.postTitle}"></td>
                        <td th:text="${app.applicantName}"></td>
                        <td th:text="${app.applicantPhone}"></td>
                        <td th:text="${#temporals.format(app.submittedAt, 'yyyy-MM-dd')}"></td>
                        <td>
                            <a th:if="${app.filePath}" th:href="@{'/files/' + ${app.filePath}}" target="_blank">다운로드</a>
                            <span th:if="${app.filePath == null}">없음</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- 회원 정보 수정 -->
        <div id="edit" style="display: none;">
            <h3>🛠️ 회원 정보 수정</h3>
            <button onclick="location.href='/member/edit'">회원 정보 수정</button>
            <button onclick="location.href='/member/password-change'">비밀번호 변경</button>
        </div>
    </div>
</div>

<script>
    function showSection(id) {
        document.querySelectorAll('.content > div').forEach(div => div.style.display = 'none');
        document.getElementById(id).style.display = 'block';
    }
</script>

</body>
</html>
